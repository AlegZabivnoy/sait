# Виправлення помилок збереження на MacOS

## Проблема
На MacOS, особливо при роботі з хмарними папками (OneDrive, iCloud), можуть виникати проблеми з правами доступу до файлів при збереженні квізів.

## Виправлення

### 1. Права доступу до папки
Виконайте в терміналі (в папці проекту):

```bash
# Надати права на запис у папку server/data
chmod -R 755 server/data

# Надати права на запис для JSON файлів
chmod 666 server/data/quizzes.json
chmod 666 server/data/results.json
```

### 2. Якщо проект в OneDrive/iCloud
Рекомендується перемістити проект в локальну папку:

```bash
# Перемістити проект з хмарної папки
mv ~/OneDrive/Desktop/projekt ~/Desktop/projekt-local
cd ~/Desktop/projekt-local
npm install
```

### 3. Перевірити права користувача
```bash
# Перевірити власника файлів
ls -la server/data/

# Якщо потрібно, змінити власника
sudo chown -R $USER:staff server/data/
```

### 4. Перезапустити сервер
```bash
cd server
npm start
```

## Що було виправлено в коді:

1. **storage.js** - Додано:
   - Перевірку прав доступу до файлів
   - Явне встановлення прав (`mode: 0o666`)
   - Детальне логування помилок
   - Створення директорії, якщо вона не існує

2. **quizzes.js** - Додано:
   - Кращу обробку помилок
   - Детальніше логування
   - Повідомлення про конкретні проблеми

## Тестування

Після виправлень спробуйте:

1. Зупинити сервер (Ctrl+C)
2. Видалити файли даних:
   ```bash
   rm server/data/quizzes.json
   rm server/data/results.json
   ```
3. Запустити сервер знову:
   ```bash
   cd server
   npm start
   ```
4. Створити новий квіз через інтерфейс

## Додаткові рекомендації

### Якщо помилка все ще виникає:

1. **Перевірте консоль сервера** - там будуть детальні повідомлення про помилку
2. **Перевірте консоль браузера** - натисніть F12 і подивіться на помилки API
3. **Перевірте Network вкладку** - подивіться на відповідь сервера

### Поширені помилки:

- `EACCES` - Немає прав доступу
  - Рішення: `chmod 666 server/data/*.json`

- `EROFS` - Файлова система тільки для читання
  - Рішення: Перемістити проект з хмарної папки

- `ENOSPC` - Немає місця на диску
  - Рішення: Звільнити місце на диску

## Контакт
Якщо проблема не вирішена, надішліть:
1. Скріншот консолі сервера з помилкою
2. Скріншот консолі браузера (F12 → Console)
3. Результат команди: `ls -la server/data/`
